---
import type { HandmadeItem } from "@/types";
import { Image } from "astro:assets";

interface Props {
  item: HandmadeItem;
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  image: any;
}

const { item, image } = Astro.props;

// Truncate description to 80 characters
const truncateDescription = (text: string, maxLength: number = 80): string => {
  if (text.length <= maxLength) return text;
  return text.substring(0, maxLength).trim() + "...";
};

const shortDescription = truncateDescription(item.description);
---

<a href={`/handmade/${item.articleNumber}`} class="group block h-full">
  <article
    class="glass flex h-full cursor-pointer flex-col overflow-hidden rounded-lg shadow-lg transition-transform group-hover:scale-105 group-hover:shadow-xl"
  >
    <div class="relative aspect-square overflow-hidden">
      <Image
        src={image}
        alt={item.name}
        class="h-full w-full object-cover"
        loading="lazy"
      />
      <div class="absolute left-2 top-2 flex items-center gap-2">
        <span
          class="glass rounded-full px-3 py-1 font-mono text-xs font-semibold"
        >
          {item.articleNumber}
        </span>
        {
          item.customizable && (
            <span
              class="glass rounded-full px-2 py-1 text-xs"
              title="Personalisierbar"
            >
              ✨
            </span>
          )
        }
      </div>
      <div class="absolute right-2 top-2">
        <span class="glass rounded-full px-3 py-1 text-xs font-semibold">
          {item.category}
        </span>
      </div>
    </div>

    <div class="flex flex-grow flex-col p-6">
      <h3 class="mb-2 text-xl font-bold text-cyan-600 dark:text-cyan-400">
        {item.name}
      </h3>
      <p class="mb-4 min-h-[3rem] text-sm opacity-80">{shortDescription}</p>

      <div class="mb-4 flex flex-wrap gap-2">
        {
          item.tags.map((tag) => (
            <span class="glass-subtle rounded px-2 py-1 text-xs">{tag}</span>
          ))
        }
      </div>

      <div class="mb-2 min-h-[2rem]">
        {
          item.size && (
            <p class="text-sm opacity-70">
              <strong>Größe:</strong> {item.size}
            </p>
          )
        }
      </div>

      <div
        class="mt-auto flex items-center justify-between border-t border-white/10 pt-4"
      >
        <span class="text-2xl font-bold text-cyan-600 dark:text-cyan-400">
          {item.price.toFixed(2)} €
        </span>
      </div>
    </div>
  </article>
</a>
