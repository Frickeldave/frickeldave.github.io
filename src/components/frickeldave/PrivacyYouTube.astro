---
interface Props {
  videoId: string;
  title: string;
}

const { videoId, title } = Astro.props;
---

<div
  class="privacy-youtube relative my-6 w-full"
  style="padding-bottom: 56.25%;"
  data-video-id={videoId}
>
  <img
    src={`https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`}
    alt="Video Vorschaubild"
    class="absolute inset-0 h-full w-full rounded-lg object-cover"
  />
  <div
    class="absolute inset-0 flex items-center justify-center rounded-lg bg-black bg-opacity-50"
  >
    <button
      class="play-button rounded-lg bg-red-600 px-6 py-3 text-white transition-colors hover:bg-red-700"
    >
      ▶️ Video laden ({title})
    </button>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".privacy-youtube").forEach((container) => {
      const button = container.querySelector(".play-button");
      const videoId = (container as HTMLElement).dataset.videoId;

      button?.addEventListener("click", function () {
        container.innerHTML = `
        <iframe 
          class="absolute top-0 left-0 w-full h-full rounded-lg"
          src="https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1" 
          title="Video"
          frameborder="0" 
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
          allowfullscreen
        ></iframe>
      `;
      });
    });
  });
</script>
