---
import type { AboutMeEntry } from "@/types";
import { Image } from "astro:assets";
import {
  FaInstagram,
  FaLinkedinIn,
  FaGithub,
  FaEnvelope,
  FaGlobe,
} from "react-icons/fa";

interface Props {
  entry: AboutMeEntry;
}

const { entry } = Astro.props;
const {
  name,
  location,
  email,
  linkedin,
  github,
  instagram,
  profileImage,
  socialLinks,
} = entry.data;

// Build social links from both sources (without website - already on site)
const allSocialLinks = [
  ...(instagram
    ? [{ name: "Instagram", url: instagram, icon: "instagram" }]
    : []),
  ...(linkedin ? [{ name: "LinkedIn", url: linkedin, icon: "linkedin" }] : []),
  ...(github ? [{ name: "GitHub", url: github, icon: "github" }] : []),
  ...(email ? [{ name: "E-Mail", url: `mailto:${email}`, icon: "email" }] : []),
  ...(socialLinks || []),
];

const getIcon = (icon: string | undefined) => {
  switch (icon) {
    case "instagram":
      return FaInstagram;
    case "linkedin":
      return FaLinkedinIn;
    case "github":
      return FaGithub;
    case "email":
      return FaEnvelope;
    case "website":
      return FaGlobe;
    default:
      return FaGlobe;
  }
};
---

<div class="row justify-center">
  <div class="col-12">
    <!-- Hero Section with Profile - Top Row -->
    <div class="glass mb-6 overflow-hidden rounded-2xl p-6 lg:p-10">
      <div class="flex flex-col items-center gap-8 lg:flex-row">
        <!-- Left: Profile Image & Name (33%) -->
        <div class="flex w-full flex-col items-center text-center lg:w-1/3">
          <div class="relative mb-4">
            {
              profileImage ? (
                <div class="relative">
                  <div class="absolute -inset-2 animate-pulse rounded-full bg-gradient-to-r from-amber-500 via-orange-500 to-red-500 opacity-75 blur-lg" />
                  <Image
                    src={profileImage}
                    alt={name || "Profile"}
                    width={220}
                    height={220}
                    class="relative h-44 w-44 rounded-full border-4 border-white/20 object-cover shadow-2xl lg:h-52 lg:w-52"
                  />
                </div>
              ) : (
                <div class="glass flex h-44 w-44 items-center justify-center rounded-full border-4 border-white/20 lg:h-52 lg:w-52">
                  <span class="text-7xl">ğŸ‘¨â€ğŸ’»</span>
                </div>
              )
            }
          </div>
          <h2
            class="text-txt-h dark:text-darkmode-txt-h text-xl font-bold lg:text-2xl"
          >
            {name}
          </h2>
          {
            location && (
              <span class="glass-t mt-2 inline-flex items-center gap-1 rounded-full px-3 py-1 text-sm text-txt-p dark:text-darkmode-txt-p">
                ğŸ“ {location}
              </span>
            )
          }
        </div>

        <!-- Right: Greeting & Roles (66%) -->
        <div class="w-full lg:w-2/3">
          {/* Greeting Title */}
          <h1
            class="mb-4 bg-gradient-to-r from-amber-500 via-orange-500 to-red-500 bg-clip-text text-2xl font-bold text-transparent lg:text-4xl"
          >
            Hey, ich bin Frickeldave! ğŸ‘‹
          </h1>

          {/* Role Tags */}
          <div class="mb-6 flex flex-wrap gap-2">
            <span
              class="glass-t rounded-full border border-amber-500/30 px-4 py-2 text-sm font-medium text-txt-p dark:text-darkmode-txt-p"
              >ğŸ’¼ Managing IT-Consultant</span
            >
            <span
              class="glass-t rounded-full border border-orange-500/30 px-4 py-2 text-sm font-medium text-txt-p dark:text-darkmode-txt-p"
              >ğŸš€ DevOps Evangelist</span
            >
            <span
              class="glass-t rounded-full border border-red-500/30 px-4 py-2 text-sm font-medium text-txt-p dark:text-darkmode-txt-p"
              >ğŸ¤– KI Enthusiast</span
            >
            <span
              class="glass-t rounded-full border border-amber-500/30 px-4 py-2 text-sm font-medium text-txt-p dark:text-darkmode-txt-p"
              >ğŸ› ï¸ DIY Maker</span
            >
            <span
              class="glass-t rounded-full border border-orange-500/30 px-4 py-2 text-sm font-medium text-txt-p dark:text-darkmode-txt-p"
              >ğŸ–¨ï¸ 3D Printing Fanatic</span
            >
            <span
              class="glass-t rounded-full border border-red-500/30 px-4 py-2 text-sm font-medium text-txt-p dark:text-darkmode-txt-p"
              >ğŸªµ Woodworking Hobbyist</span
            >
          </div>

          {/* Intro Text (integrated here instead of separate box) */}
          <div class="prose prose-lg max-w-none dark:prose-invert">
            {
              typeof entry.data.intro === "object" &&
                entry.data.intro &&
                "content" in entry.data.intro && (
                  <p class="text-base leading-relaxed text-txt-p dark:text-darkmode-txt-p lg:text-lg">
                    {entry.data.intro.content}
                  </p>
                )
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Social Links Section -->
    <div class="glass rounded-xl p-6">
      <h3
        class="text-txt-h dark:text-darkmode-txt-h mb-4 text-center text-xl font-bold"
      >
        Vernetze dich mit mir
      </h3>
      <div class="flex flex-wrap justify-center gap-4">
        {
          allSocialLinks.map((link) => {
            const IconComponent = getIcon(link.icon);
            return (
              <a
                href={link.url}
                target={link.url.startsWith("mailto:") ? "_self" : "_blank"}
                rel="noopener noreferrer"
                class="group flex items-center gap-3 rounded-xl bg-gradient-to-r from-amber-500 to-orange-500 px-5 py-3 font-medium text-white transition-all duration-300 hover:scale-105 hover:from-amber-600 hover:to-orange-600 hover:shadow-lg"
                aria-label={link.name}
              >
                <IconComponent className="text-xl text-white" />
                <span>{link.name}</span>
              </a>
            );
          })
        }
      </div>
    </div>
  </div>
</div>

<style>
  .animate-pulse {
    animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 0.5;
    }
    50% {
      opacity: 0.8;
    }
  }
</style>
